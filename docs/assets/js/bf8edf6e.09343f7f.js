"use strict";(self.webpackChunkdev_portal=self.webpackChunkdev_portal||[]).push([[580],{4757:(e,a,t)=>{t.d(a,{Z:()=>l});var i=t(7294);function l(e){var a,t=e.method,l=e.url;switch(t){case"GET":a="#007959";break;case"POST":a="#0071BB";break;case"PUT":a="#DEA700";break;case"DELETE":a="#DF245E"}return i.createElement("div",{style:{display:"flex",flexDirection:"row",fontSize:"15px",lineHeight:"15px",marginBottom:"13px"}},i.createElement("span",{style:{backgroundColor:a,color:"var(--tape-color-lightest)",borderRadius:"999px",padding:"4px 9px 3px 9px",fontWeight:700,fontSize:"11px",lineHeight:"11px"}},t.toUpperCase()),i.createElement("span",{style:{color:"var(--tape-color-darker)",marginLeft:"9px",marginTop:"2px"}},l))}},2534:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>f,contentTitle:()=>u,default:()=>b,frontMatter:()=>m,metadata:()=>c,toc:()=>h});var i=t(7462),l=t(3366),n=(t(7294),t(3905)),o=t(7859),r=t(4757),p=t(9877),s=t(8215),d=["components"],m={id:"file",title:"File",sidebar_label:"File"},u=void 0,c={unversionedId:"api/resource/file",id:"api/resource/file",title:"File",description:"A file is a container for data and primarily identified by its file name. A file could be a spreadsheet, an image, PDF, video, or just binary data. Tape supports various file formats to be attached to resources like records, comments and chat messages.",source:"@site/docs/api/resource/file.md",sourceDirName:"api/resource",slug:"/api/resource/file",permalink:"/docs/api/resource/file",editUrl:"https://github.com/tape-dev/developers.tapeapp.com/edit/main/apps/dev-portal/docs/api/resource/file.md",tags:[],version:"current",frontMatter:{id:"file",title:"File",sidebar_label:"File"},sidebar:"mainSidebar",previous:{title:"Workspace",permalink:"/docs/api/resource/workspace"},next:{title:"Link Preview",permalink:"/docs/api/resource/link-preview"}},f={},h=[{value:"Upload a file",id:"upload-a-file",level:2},{value:"Upload multiple files",id:"upload-multiple-files",level:2},{value:"Thumbnails",id:"thumbnails",level:2},{value:"Upload limits",id:"upload-limits",level:2},{value:"Rate limit credits",id:"rate-limit-credits",level:2},{value:"Validation errors",id:"validation-errors",level:2}],k={toc:h};function b(e){var a=e.components,t=(0,l.Z)(e,d);return(0,n.kt)("wrapper",(0,i.Z)({},k,t,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"A file is a container for data and primarily identified by its file name. A file could be a spreadsheet, an image, PDF, video, or just binary data. Tape supports various file formats to be attached to resources like records, comments and chat messages."),(0,n.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"There are many reasons why a file upload via HTTP can fail (file too large, bad network connection, ...). To prevent critical operations like creating a record to fail due to an unsuccessful upload, attaching a file to a resource is a two-step process:"),(0,n.kt)("ol",{parentName:"div"},(0,n.kt)("li",{parentName:"ol"},"The file is uploaded to Tape and the server returns a unique file ID."),(0,n.kt)("li",{parentName:"ol"},"The file ID is used to attach the uploaded file to a resource (record, comment, ...).")))),(0,n.kt)("p",null,"Files can be uploaded to Tape via the API by using the ",(0,n.kt)("inlineCode",{parentName:"p"},"multipart/form-data")," HTTP content type. Once uploaded, file objects have a unique ",(0,n.kt)("inlineCode",{parentName:"p"},"file_id"),", a ",(0,n.kt)("inlineCode",{parentName:"p"},"name"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"size")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"link"),". The ",(0,n.kt)("inlineCode",{parentName:"p"},"link")," URL will expire after some hours, after which the file cannot be downloaded anymore via that URL. You can retrieve the file again to obtain a fresh ",(0,n.kt)("inlineCode",{parentName:"p"},"link"),"."),(0,n.kt)("p",null,"Files that have been attached to a resource are deleted and can only be retrieved in the context of the resource. Files that are uploaded but not attached to a resource will be deleted automatically after 24 hours."),(0,n.kt)("h2",{id:"upload-a-file"},"Upload a file"),(0,n.kt)(r.Z,{method:"POST",url:"https://api.tapeapp.com/v1/file/upload",mdxType:"EndpointBadge"}),(0,n.kt)("p",null,"A single file can be uploaded via the ",(0,n.kt)("inlineCode",{parentName:"p"},"/file/upload")," endpoint via the ",(0,n.kt)("inlineCode",{parentName:"p"},"file")," field:"),(0,n.kt)(p.Z,{mdxType:"Tabs"},(0,n.kt)(s.Z,{value:"curl",label:"cURL",mdxType:"TabItem"},(0,n.kt)(o.Z,{language:"shell",title:"\u27a1\ufe0f \xa0\xa0   Request",mdxType:"ContextCodeBlock"},"curl #BASE_URL/v1/file/upload \\\n  -u #USER_API_KEY: \\\n  -F 'file=@./filename.txt'\n")),(0,n.kt)(s.Z,{value:"http",label:"HTTP",mdxType:"TabItem"},(0,n.kt)(o.Z,{language:"http",title:"\u27a1\ufe0f \xa0\xa0   Request",mdxType:"ContextCodeBlock"},"POST /v1/file/upload HTTP/1.1\nHost: api.tapeapp.com\nAuthorization: Bearer #USER_API_KEY\nAccept: */*\nContent-Length: 20\nContent-Type: multipart/form-data"))),(0,n.kt)("p",null,"The response will be a file object containing information of the uploaded file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="\u2b05\ufe0f \xa0\xa0   Response"',title:'"\u2b05\ufe0f',"\xa0\xa0":!0,"":!0,'Response"':!0},'{\n  "file_id": "temporary-file-1",\n  "name": "filename.txt",\n  "size": 20,\n  "mimetype": "text/plain",\n  "created_on": "2022-01-01 12:00:00",\n  "link": "https://s3.eu-central-1.amazonaws.com/tape-attachments/9d43730ffad8d249e3ac313193cd83?Expires=1648134130&Signature=VzrbvlfI35hp4iU7jMa%2BK%2FnutPU%3D",\n  "thumbnail": {\n    "small": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/def09e9319ca30e9ab2bc13e061982",\n    "medium": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/82f3c2669deca95c16d1ad955734e0",\n    "large": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/f8f105f4daaced0f3f714b5ebb76ae"\n  }\n}\n')),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"thumbnail")," property is optional and will only be available in case a ",(0,n.kt)("a",{parentName:"p",href:"#thumbnails"},"thumbnail")," could be generated for the uploaded file (e.g., if it is an image)."),(0,n.kt)("h2",{id:"upload-multiple-files"},"Upload multiple files"),(0,n.kt)(r.Z,{method:"POST",url:"https://api.tapeapp.com/v1/file/upload",mdxType:"EndpointBadge"}),(0,n.kt)("p",null,"Multiple files can be uploaded at the same time via the ",(0,n.kt)("inlineCode",{parentName:"p"},"/file/upload")," endpoint by providing the ",(0,n.kt)("inlineCode",{parentName:"p"},"file")," field multiple times:"),(0,n.kt)(p.Z,{mdxType:"Tabs"},(0,n.kt)(s.Z,{value:"curl",label:"cURL",mdxType:"TabItem"},(0,n.kt)(o.Z,{language:"shell",title:"\u27a1\ufe0f \xa0\xa0   Request",mdxType:"ContextCodeBlock"},"curl #BASE_URL/v1/file/upload \\\n  -u #USER_API_KEY: \\\n  -F 'file=@./filename1.txt' \\\n  -F 'file=@./filename2.txt'\n")),(0,n.kt)(s.Z,{value:"http",label:"HTTP",mdxType:"TabItem"},(0,n.kt)(o.Z,{language:"http",title:"\u27a1\ufe0f \xa0\xa0   Request",mdxType:"ContextCodeBlock"},"POST /v1/file/upload HTTP/1.1\nHost: api.tapeapp.com\nAuthorization: Bearer #USER_API_KEY\nAccept: */*\nContent-Length: 40\nContent-Type: multipart/form-data"))),(0,n.kt)("p",null,"The response will be an array of file objects containing information of the uploaded files:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="\u2b05\ufe0f \xa0\xa0   Response"',title:'"\u2b05\ufe0f',"\xa0\xa0":!0,"":!0,'Response"':!0},'[\n  {\n    "file_id": "temporary-file-2",\n    "name": "filename1.txt",\n    "size": 20,\n    "mimetype": "text/plain",\n    "created_on": "2022-01-01 12:00:00",\n    "link": "https://s3.eu-central-1.amazonaws.com/tape-attachments/d429d8095b14a641f05a1a45e946c9?Expires=1648134279&Signature=5fS7eq7HVBXNauF94KpejfIZbjo%3D"\n  },\n  {\n    "file_id": "temporary-file-3",\n    "name": "filename2.txt",\n    "size": 20,\n    "mimetype": "text/plain",\n    "created_on": "2022-01-01 12:00:00",\n    "link": "https://s3.eu-central-1.amazonaws.com/tape-attachments/fab57aefe677c3c07c6e6425c441cf?Expires=1648134325&Signature=Zx1ENKO%2FcHOqvAJSOYzv7Dta%2F1U%3D",\n    "thumbnail": {\n      "small": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/def09e9319ca30e9ab2bc13e061982",\n      "medium": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/82f3c2669deca95c16d1ad955734e0",\n      "large": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/f8f105f4daaced0f3f714b5ebb76ae"\n    }\n  }\n]\n')),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"thumbnail")," property is optional and will only be available in case a ",(0,n.kt)("a",{parentName:"p",href:"#thumbnails"},"thumbnail")," could be generated for the uploaded file (e.g., if it is an image)."),(0,n.kt)("p",null,"If you intended to upload multiple files but only provided one, you receive a single file object instead of an array. The API will always return a file object if only one file was uploaded and an array of file objects if more than one file was uploaded."),(0,n.kt)("h2",{id:"thumbnails"},"Thumbnails"),(0,n.kt)("p",null,"Tape tries to generate thumbnail images for uploaded files in multiple sizes. Thumbnails are optimized for displaying them as a user avatar, a file thumbnail or something similar. Thumbnails will be available in different sizes depending on their use:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"small"),": JPG with 100px width and 100px height"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"medium"),": JPG with 200px width and 200px height"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"large"),": JPG with the image's original width and height")),(0,n.kt)("p",null,"An example thumbnail object:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "small": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/def09e9319ca30e9ab2bc13e061982",\n  "medium": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/82f3c2669deca95c16d1ad955734e0",\n  "large": "https://s3.eu-central-1.amazonaws.com/tape-thumbnails/f8f105f4daaced0f3f714b5ebb76ae"\n}\n')),(0,n.kt)("h2",{id:"upload-limits"},"Upload limits"),(0,n.kt)("p",null,"The following limits are enforced for all file upload enpoints:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Variable"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Limit"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Maximum file size"),(0,n.kt)("td",{parentName:"tr",align:"left"},"100MB")))),(0,n.kt)("h2",{id:"rate-limit-credits"},"Rate limit credits"),(0,n.kt)("p",null,"File uploads are rate limited based on their filesize. For uploading multiple files, the sum of all filesizes is used. The filesize limit for a single file is 100MB. Uploading a file always cost 2x credits of a normal request. Uploading a file with the maximum filesize costs 4x credits. Uploading a file with half of the maximum file size costs 3x credits:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Uploading 1KB: 2x credits\nUploading 50MB: 3x credits\nUploading 100MB: 4x credits\nUploading 150MB: 5x credits\nUploading 200MB: 6x credits\nUploading 300MB: 8x credits\n...\n")),(0,n.kt)("p",null,"As you can see, uploading multiple files at once costs less credits than uploading every file individually."),(0,n.kt)("h2",{id:"validation-errors"},"Validation errors"),(0,n.kt)("p",null,"A lot can go wrong when uploading files via HTTP. Tape handles most error cases and returns detailed error messages."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="No file provided validation error"',title:'"No',file:!0,provided:!0,validation:!0,'error"':!0},'{\n  "status_code": 400,\n  "endpoint": "/v1/file/upload",\n  "error_code": "validation",\n  "error_message": "No file provided to upload endpoint \'/v1/file/upload/\' via multipart/form-data name: \'file\'"\n}\n')))}b.isMDXComponent=!0}}]);