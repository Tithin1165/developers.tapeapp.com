"use strict";(self.webpackChunkdev_portal=self.webpackChunkdev_portal||[]).push([[6611],{1680:(e,o,t)=>{t.d(o,{Z:()=>n});var a=t(6010),s=t(7294);const r="shadow_cl6l";function n(e){var o=e.children;return s.createElement("div",{className:(0,a.Z)(r)},o)}},8415:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>k,contentTitle:()=>f,default:()=>w,frontMatter:()=>c,metadata:()=>h,toc:()=>b});var a=t(7462),s=t(3366),r=(t(7294),t(3905));const n=t.p+"assets/images/google-forms-automation-trigger-1761b1b1b277a0955f12ecb3f43ffbfd.png",i=t.p+"assets/images/google-forms-automation-f0c91aaff1f17aff514031068fc4d535.png",p=t.p+"assets/images/google-forms-step-1-844dc751cc2dfb79806c61a61763b183.png",l=t.p+"assets/images/google-forms-step-2-6689587365dd74a4dfdfc8dcf4fab77a.png",m=t.p+"assets/images/google-forms-step-3-d7b1b756bb524beb6879e9d71ba6288b.png",g=t.p+"assets/images/google-forms-step-4-6cca58026a47cbda060d737ccde1d3b9.png";var d=t(1680),u=["components"],c={id:"save-google-form-responses-to-tape",title:"Connect Google Forms to Tape"},f=void 0,h={unversionedId:"guide/automations/save-google-form-responses-to-tape",id:"guide/automations/save-google-form-responses-to-tape",title:"Connect Google Forms to Tape",description:"Google Forms is a popular tool for creating online forms and surveys. Users can easily create their forms via a drag-and-drop editor. In this guide, we will build a simple workflow to save the responses of a Google form in Tape using the webhook trigger.",source:"@site/docs/guide/automations/webhook-google-forms.md",sourceDirName:"guide/automations",slug:"/guide/automations/save-google-form-responses-to-tape",permalink:"/docs/guide/automations/save-google-form-responses-to-tape",editUrl:"https://github.com/tape-dev/developers.tapeapp.com/edit/main/apps/dev-portal/docs/guide/automations/webhook-google-forms.md",tags:[],version:"current",frontMatter:{id:"save-google-form-responses-to-tape",title:"Connect Google Forms to Tape"},sidebar:"guidesSidebar",previous:{title:"Convert a PDF file to text",permalink:"/docs/guide/automations/convert-pdf-to-text"},next:{title:"Connect Jotform to Tape",permalink:"/docs/guide/automations/save-jotform-responses-to-tape"}},k={},b=[{value:"Create a new automation",id:"create-a-new-automation",level:2},{value:"Register a webhook in Google Forms",id:"register-a-webhook-in-google-forms",level:2},{value:"Create a new record for each submission",id:"create-a-new-record-for-each-submission",level:2}],v={toc:b};function w(e){var o=e.components,t=(0,s.Z)(e,u);return(0,r.kt)("wrapper",(0,a.Z)({},v,t,{components:o,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.google.com/forms/about/"},"Google Forms")," is a popular tool for creating online forms and surveys. Users can easily create their forms via a drag-and-drop editor. In this guide, we will build a simple workflow to save the responses of a Google form in Tape using the ",(0,r.kt)("strong",{parentName:"p"},"webhook trigger"),"."),(0,r.kt)("h2",{id:"create-a-new-automation"},"Create a new automation"),(0,r.kt)("p",null,"The first step is to create a new automation in Tape with the ",(0,r.kt)("strong",{parentName:"p"},"webhook trigger")," and to copy the webhook URL:"),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:n})),(0,r.kt)("br",null),(0,r.kt)("p",null,"Head over to ",(0,r.kt)("a",{parentName:"p",href:"https://www.google.com/forms/"},"Google Forms")," and create your online form with the form builder. Once you are satisfied with your form, you need to register a webhook."),(0,r.kt)("h2",{id:"register-a-webhook-in-google-forms"},"Register a webhook in Google Forms"),(0,r.kt)("p",null,"To register a webhook in Google Forms, you need to open the ",(0,r.kt)("strong",{parentName:"p"},"Script editor")," from the settings:"),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:p})),(0,r.kt)("br",null),(0,r.kt)("p",null,"Once you opened the script editor, replace ",(0,r.kt)("inlineCode",{parentName:"p"},"https://tapeapp.com/api/catch/YOUR_WEBHOOK_URL_HERE")," with the URL of your webhook trigger in the code below and copy&paste the resulting code into the editor:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"var POST_URL = 'https://tapeapp.com/api/catch/YOUR_WEBHOOK_URL_HERE';\nfunction onSubmit(e) {\n  var form = FormApp.getActiveForm();\n  var allResponses = form.getResponses();\n  var latestResponse = allResponses[allResponses.length - 1];\n  var response = latestResponse.getItemResponses();\n  var payload = {};\n  for (var i = 0; i < response.length; i++) {\n    var question = response[i]\n      .getItem()\n      .getTitle()\n      .replace(/[^a-zA-Z0-9]/g, '_');\n    var answer = response[i].getResponse();\n    payload[question] = answer;\n  }\n\n  var options = {\n    method: 'post',\n    contentType: 'application/json',\n    payload: JSON.stringify(payload),\n  };\n  UrlFetchApp.fetch(POST_URL, options);\n}\n")),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:l})),(0,r.kt)("br",null),(0,r.kt)("p",null,"Hit the save icon and the ",(0,r.kt)("strong",{parentName:"p"},"Deploy"),' button to activate your webhook script. You might need to grant permissions to yourself under the "Advanced" option:'),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:m})),(0,r.kt)("br",null),(0,r.kt)("p",null,"Lastly, you have to create a Google Forms Trigger under the ",(0,r.kt)("strong",{parentName:"p"},"Triggers"),' menu option on the left. Choose "onSubmit", "Head", "From form" and "On form submit" as the options:'),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:g})),(0,r.kt)("br",null),(0,r.kt)("h2",{id:"create-a-new-record-for-each-submission"},"Create a new record for each submission"),(0,r.kt)("p",null,'Now that we have set up the Google forms webhook, we can submit a response to our form and head back to the Tape automation. After hitting the "Refresh" button, one variable for each form question will be available inside the automation:'),(0,r.kt)(d.Z,{mdxType:"MediaFrame"},(0,r.kt)("img",{src:i})),(0,r.kt)("br",null),(0,r.kt)("p",null,"That's it! You can use this guide to connect pretty much any online form provider that offers webhooks (and hofepully makes them easier to set up...)."))}w.isMDXComponent=!0}}]);